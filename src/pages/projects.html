---
menu: base.lists
title: Progetti
page-header: Pannello
menu: base.lists
layout-sidebar: true
layout-navbar-transparent: true
layout-hide-topbar: true
page-header-actions: buttons
---

<div class="row row-cards">

		<div class="row row-cards">
			<div class="col-12">
				{% include cards/users-list.html hoverable=true  %}
			</div>
		</div>
</div>

<script>
	const accessToken = localStorage.getItem('access_token');
	// Fetch data from your API
	fetch('http://senato.asimov.law:8000/users/me/projects/', {
		method: 'GET',
		headers: {
			'Accept': 'application/json',
			// 'Content-Type': 'application/x-www-form-urlencoded',
			'Authorization': `Bearer ${accessToken}`,
		},
	})
		.then(response => {
			// Check if the request was successful
			if (!response.ok) {
				throw new Error(`HTTP error! status: ${response.status}`);
			}
			return response.json();
		})
		.then(data => {
			// If successful, update your items
			updateItems(data);
		})
		.catch(error => {
			console.log('Authentication problem, try login again' + error.message);
			window.location.href = '/sign-in.html';
		});

	// Function to update items on the page
	function updateItems(data) {
		// Select the container where you want to add the items
		const col12Container = document.querySelector('.col-12');

		// Query for .list-group within the scope of .col-12
		const container = col12Container.querySelector('.list-group');

		// Clear the container
		container.innerHTML = '';

		// Loop through the data and create new items
		data.forEach(item => {
			const newItem = document.createElement('div');
			newItem.classList.add('list-group-item');
			newItem.innerHTML = `
      <div class="row align-items-center">
        <div class="col-auto"><span class="badge red"></span></div>

        <div class="col text-truncate">
          <a href="#" class="text-reset d-block">${item.name}</a>
          <div class="d-block text-secondary text-truncate mt-n1">${item.user}</div>
        </div>
        <div class="col-auto">
          <a href="#" class="list-group-item-actions"><!-- Add your star SVG icon here --></a>
        </div>
      </div>
    `;
			container.appendChild(newItem);
		});
	}

</script>